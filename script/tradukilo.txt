# ===============================================
# Script: ตัวช่วยในการแปลแบบรวดเร็ว โดยปกติจะต้องผ่าน
# การตรวจสอบด้วยคนก่อนบันทึก
# ===============================================

document.addEventListener("mouseup", async () => {
  const selection = window.getSelection();
  const selectedText = selection.toString().trim();

  if (selectedText) {
    const sourceDiv = document.getElementById("source-string");
    if (sourceDiv.contains(selection.anchorNode)) {
      console.log("Selected text:", selectedText);

      const apiUrl = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=th&dt=t&q=${encodeURIComponent(selectedText)}`;
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        let translatedText = data[0].map(item => item[0]).join("");

        // Lowercase all, capitalize first letter
        translatedText = translatedText.toLowerCase();
        translatedText = translatedText.charAt(0).toUpperCase() + translatedText.slice(1);

        console.log("Final translated text:", translatedText);
        document.getElementById("translated-string").innerHTML = translatedText;
      } catch (error) {
        console.error("Translation error:", error);
      }
    }
  }
});
===========
document.addEventListener("mouseup", async () => {
  const selection = window.getSelection();
  const selectedText = selection.toString().trim();

  if (selectedText) {
    const sourceDiv = document.getElementById("source-string");
    if (sourceDiv.contains(selection.anchorNode)) {
      console.log("Selected text:", selectedText);

      const apiUrl = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=eo&dt=t&q=${encodeURIComponent(selectedText)}`;
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        let translatedText = data[0].map(item => item[0]).join("");

        // Lowercase all, capitalize first letter
        translatedText = translatedText.toLowerCase();
        translatedText = translatedText.charAt(0).toUpperCase() + translatedText.slice(1);

        console.log("Final translated text:", translatedText);
        document.getElementById("translated-string").innerHTML = translatedText;
      } catch (error) {
        console.error("Translation error:", error);
      }
    }
  }
});